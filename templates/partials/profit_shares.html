{% if deal.profit_shares %}
<div class="overflow-x-auto">
    <table class="table table-sm">
        <thead>
            <tr class="text-base-content/60">
                <th>Team Member</th>
                <th>Percentage</th>
                <th>Flat Amount</th>
                <th>Total Share</th>
                <th class="w-16"></th>
            </tr>
        </thead>
        <tbody>
            {% for share in deal.profit_shares %}
            <tr class="hover:bg-base-300/30" data-testid="row-share-{{ share.id }}">
                <td>
                    <div class="flex items-center gap-2">
                        <div class="avatar placeholder">
                            <div class="bg-purple-500/20 text-purple-400 rounded-full w-8">
                                <span class="text-xs">{{ share.user.username[0].upper() }}</span>
                            </div>
                        </div>
                        <span>{{ share.user.full_name or share.user.username }}</span>
                    </div>
                </td>
                <td>{{ share.percentage }}%</td>
                <td>${{ "{:,.2f}".format(share.flat_amount) }}</td>
                <td class="font-semibold text-success">${{ "{:,.2f}".format(share.calculated_amount) }}</td>
                <td>
                    <form hx-post="{{ url_for('delete_profit_share', share_id=share.id) }}" hx-target="#profit-shares" hx-swap="innerHTML" hx-confirm="Remove this profit share?">
                        <button type="submit" class="btn btn-ghost btn-xs text-error" data-testid="button-delete-share-{{ share.id }}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr class="border-t border-base-300">
                <td colspan="3" class="text-right font-semibold">Total Shared:</td>
                <td class="font-bold text-success">
                    ${{ "{:,.2f}".format(deal.profit_shares|sum(attribute='calculated_amount')) }}
                </td>
                <td></td>
            </tr>
        </tfoot>
    </table>
</div>
{% else %}
<div class="text-center py-6 text-base-content/40">
    <i class="fas fa-pie-chart text-3xl mb-2"></i>
    <p class="text-sm">No profit shares defined</p>
</div>
{% endif %}
